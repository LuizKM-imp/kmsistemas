<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Levantamento de Implantação</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.5.0/docx.umd.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 {
      text-align: center;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      margin-top: 30px;
      padding: 12px 20px;
      font-size: 16px;
      background: #2d6cdf;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #1f4fb8;
    }
  </style>
</head>
<body>

<h1>Levantamento de Implantação</h1>

<form id="form">
  <label>Quantidade de empresas e CNPJ:</label>
  <textarea id="empresas"></textarea>

  <label>Usuários (nome e função):</label>
  <textarea id="usuarios"></textarea>

  <label>Dores do cliente:</label>
  <textarea id="dores"></textarea>

  <label>Dias disponíveis para agenda:</label>
  <input type="text" id="agenda">

  <label>Paga comissão sobre vendas?</label>
  <input type="text" id="comissao">

  <label>Tipo de comissão:</label>
  <input type="text" id="tipoComissao">

  <label>Utiliza PDV?</label>
  <input type="text" id="pdv">

  <label>Controla estoque?</label>
  <input type="text" id="estoque">

  <label>Como é feito o controle de produção?</label>
  <textarea id="producao"></textarea>

  <label>Vai emitir NF-e?</label>
  <input type="text" id="nfe">

  <label>Nome do contador:</label>
  <input type="text" id="contador">

  <label>Faz conciliação bancária?</label>
  <input type="text" id="conciliacao">

  <button type="button" onclick="gerarDoc()">Gerar Documento Word</button>
</form>

<script>
  async function gerarDoc() {
    const { Document, Packer, Paragraph, HeadingLevel } = window.docx;

    function valor(id) {
      return document.getElementById(id).value || "-";
    }

    const doc = new Document({
      sections: [{
        children: [
          new Paragraph({
            text: "Levantamento de Regras e Processos para Implantação",
            heading: HeadingLevel.TITLE
          }),

          new Paragraph({ text: "1. Informações Gerais", heading: HeadingLevel.HEADING_1 }),
          new Paragraph("Empresas e CNPJ: " + valor("empresas")),
          new Paragraph("Usuários: " + valor("usuarios")),

          new Paragraph({ text: "2. Diagnóstico", heading: HeadingLevel.HEADING_1 }),
          new Paragraph("Dores do cliente: " + valor("dores")),
          new Paragraph("Agenda disponível: " + valor("agenda")),

          new Paragraph({ text: "3. Comercial", heading: HeadingLevel.HEADING_1 }),
          new Paragraph("Paga comissão: " + valor("comissao")),
          new Paragraph("Tipo de comissão: " + valor("tipoComissao")),
          new Paragraph("Utiliza PDV: " + valor("pdv")),

          new Paragraph({ text: "4. Estoque", heading: HeadingLevel.HEADING_1 }),
          new Paragraph("Controle de estoque: " + valor("estoque")),

          new Paragraph({ text: "5. Produção", heading: HeadingLevel.HEADING_1 }),
          new Paragraph("Controle de produção: " + valor("producao")),

          new Paragraph({ text: "6. Faturamento", heading: HeadingLevel.HEADING_1 }),
          new Paragraph("Emite NF-e: " + valor("nfe")),
          new Paragraph("Contador: " + valor("contador")),

          new Paragraph({ text: "7. Tesouraria", heading: HeadingLevel.HEADING_1 }),
          new Paragraph("Conciliação bancária: " + valor("conciliacao")),
        ]
      }]
    });

    const blob = await Packer.toBlob(doc);
    saveAs(blob, "Levantamento_Cliente.docx");
  }
</script>

</body>
</html>
